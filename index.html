<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Note Taking App</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet" />
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          colors: {
            'royal-red': {
              50: '#fef2f2',
              100: '#fee2e2',
              200: '#fecaca',
              300: '#fca5a5',
              400: '#f87171',
              500: '#ef4444',
              600: '#dc2626',
              700: '#b91c1c',
              800: '#991b1b',
              900: '#7f1d1d',
            }
          }
        }
      }
    }
  </script>
  <style>
    body {
      font-family: 'Inter', sans-serif;
      transition: background-color 0.1s, color 0.1s;
    }

    .theme-transition {
      transition: background-color 0.1s, border-color 0.1s, color 0.1s, box-shadow 0.1s;
    }
  </style>
</head>

<body class="bg-zinc-50 dark:bg-zinc-900 min-h-screen flex flex-col theme-transition">
  <header class="bg-white dark:bg-zinc-800 shadow-md p-4 flex items-center justify-between theme-transition">
    <h1 class="text-2xl font-semibold text-zinc-800 dark:text-white flex items-center gap-2">
      <i class="fas fa-sticky-note text-royal-red-600"></i>
      Note Taking App
    </h1>
    <div class="flex items-center gap-4">
      <button id="themeToggle" class="p-2 rounded-full hover:bg-zinc-100 dark:hover:bg-zinc-700 theme-transition"
        aria-label="Toggle theme">
        <i id="themeIcon" class="fas fa-sun text-yellow-500 dark:text-yellow-300"></i>
      </button>
    </div>
  </header>

  <main class="flex-grow container mx-auto p-4 max-w-4xl flex flex-col md:flex-row gap-6">
    <!-- Notes List -->
    <section class="md:w-1/3 bg-white dark:bg-zinc-800 rounded-lg shadow-md p-4 flex flex-col theme-transition">
      <div class="flex items-center justify-between mb-4">
        <h2 class="text-lg font-semibold text-zinc-700 dark:text-zinc-200 theme-transition">Your Notes</h2>
        <button id="addNoteBtn"
          class="text-white bg-royal-red-600 hover:bg-royal-red-700 focus:ring-2 focus:ring-royal-red-500 focus:ring-opacity-50 rounded-md px-3 py-1.5 flex items-center gap-2 transition-colors"
          aria-label="Add new note">
          <i class="fas fa-plus"></i> New
        </button>
      </div>
      <div class="border-b border-zinc-200 dark:border-zinc-700 mb-3 theme-transition"></div>
      <ul id="notesList" class="overflow-y-auto flex-grow space-y-2">
        <!-- Notes will be appended here -->
      </ul>
    </section>

    <!-- Note Editor -->
    <section class="md:w-2/3 bg-white dark:bg-zinc-800 rounded-lg shadow-md p-6 flex flex-col theme-transition">
      <input type="text" id="noteTitle" placeholder="Note Title"
        class="border border-zinc-300 dark:border-zinc-600 bg-white dark:bg-zinc-700 rounded-md px-4 py-2 mb-4 focus:outline-none focus:ring-2 focus:ring-royal-red-500 text-zinc-800 dark:text-white text-lg font-semibold theme-transition"
        aria-label="Note title" />
      <textarea id="noteContent" placeholder="Write your note here..."
        class="border border-zinc-300 dark:border-zinc-600 bg-white dark:bg-zinc-700 rounded-md px-4 py-3 flex-grow resize-none focus:outline-none focus:ring-2 focus:ring-royal-red-500 text-zinc-700 dark:text-zinc-200 theme-transition"
        rows="12" aria-label="Note content"></textarea>
      <div class="mt-4 flex justify-end gap-3">
        <button id="deleteNoteBtn"
          class="bg-zinc-200 dark:bg-zinc-700 hover:bg-zinc-300 dark:hover:bg-zinc-600 text-zinc-700 dark:text-zinc-200 rounded-md px-4 py-2 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 transition-colors theme-transition"
          disabled aria-label="Delete note">
          <i class="fas fa-trash-alt"></i> Delete
        </button>
        <button id="saveNoteBtn"
          class="bg-royal-red-600 hover:bg-royal-red-700 text-white rounded-md px-4 py-2 flex items-center gap-2 transition-colors focus:ring-2 focus:ring-royal-red-500 focus:ring-opacity-50"
          aria-label="Save note">
          <i class="fas fa-save"></i> Save
        </button>
      </div>
    </section>
  </main>

  <footer
    class="bg-white dark:bg-zinc-800 shadow-md p-4 text-center text-zinc-500 dark:text-zinc-400 text-sm theme-transition">
    &copy; 2022 Note Taking App. Made by
    <a href="https://github.com/saad2134" class=" text-royal-red-600 hover:text-royal-red-700 theme-transition"
      target="_blank" rel="noopener noreferrer">Saad</a>.
    All rights reserved.
    <br>
    <a class=" text-gray-500 theme-transition">
      All data is saved in browser local storage. Clearing history or using private mode will lead to loss of data.</a>
  </footer>


  <script>
    const addNoteBtn = document.getElementById('addNoteBtn');
    const saveNoteBtn = document.getElementById('saveNoteBtn');
    const deleteNoteBtn = document.getElementById('deleteNoteBtn');
    const notesList = document.getElementById('notesList');
    const noteTitle = document.getElementById('noteTitle');
    const noteContent = document.getElementById('noteContent');
    const themeToggle = document.getElementById('themeToggle');
    const themeIcon = document.getElementById('themeIcon');

    let notes = [];
    let selectedNoteId = null;
    let currentTheme = 'system'; // 'light', 'dark', or 'system'

    // Theme Management
    function setTheme(theme) {
      currentTheme = theme;
      localStorage.setItem('theme', theme);

      const isDark = theme === 'dark' ||
        (theme === 'system' && window.matchMedia('(prefers-color-scheme: dark)').matches);

      if (isDark) {
        document.documentElement.classList.add('dark');
        themeIcon.className = 'fas fa-moon text-blue-300';
      } else {
        document.documentElement.classList.remove('dark');
        themeIcon.className = 'fas fa-sun text-yellow-500';
      }
    }

    function initTheme() {
      const savedTheme = localStorage.getItem('theme') || 'system';
      setTheme(savedTheme);
    }

    function toggleTheme() {
      if (currentTheme === 'light') {
        setTheme('dark');
      } else if (currentTheme === 'dark') {
        setTheme('system');
      } else {
        setTheme('light');
      }

      // Show feedback about selected theme
      const themeNames = {
        'light': 'Light Mode',
        'dark': 'Dark Mode',
        'system': 'System Theme'
      };

      //showNotification(`Switched to ${themeNames[currentTheme]}`);
    }

    // Notification function
    function showNotification(message) {
      const notification = document.createElement('div');
      notification.className = 'fixed bottom-4 right-4 bg-zinc-800 dark:bg-zinc-200 text-white dark:text-zinc-800 rounded-md px-4 py-2 shadow-lg theme-transition';
      notification.textContent = message;
      document.body.appendChild(notification);

      setTimeout(() => {
        notification.remove();
      }, 2000);
    }

    // Note Management Functions
    function saveNotesToStorage() {
      localStorage.setItem('notes', JSON.stringify(notes));
    }

    function loadNotesFromStorage() {
      const storedNotes = localStorage.getItem('notes');
      if (storedNotes) {
        notes = JSON.parse(storedNotes);
      } else {
        notes = [];
      }
    }

    function renderNotesList() {
      notesList.innerHTML = '';
      if (notes.length === 0) {
        const emptyMsg = document.createElement('div');
        emptyMsg.className = 'text-zinc-400 dark:text-zinc-500 text-center mt-8 flex flex-col items-center';

        const icon = document.createElement('i');
        icon.className = 'fas fa-sticky-note text-4xl mb-2 text-zinc-300 dark:text-zinc-600';

        const text = document.createElement('p');
        text.textContent = 'No notes yet';

        const subtext = document.createElement('p');
        subtext.className = 'text-sm mt-1';
        subtext.textContent = 'Click "New" to add one';

        emptyMsg.appendChild(icon);
        emptyMsg.appendChild(text);
        emptyMsg.appendChild(subtext);

        notesList.appendChild(emptyMsg);
        return;
      }

      notes.forEach((note) => {
        const li = document.createElement('li');
        li.className =
          'cursor-pointer p-3 rounded-md hover:bg-zinc-300 bg-zinc-100 dark:bg-zinc-700 dark:hover:bg-zinc-900 theme-transition ' +
          (note.id === selectedNoteId ? 'bg-royal-red-50 dark:bg-royal-red-900 dark:bg-opacity-20 border-l-4 border-royal-red-600' : '');
        li.setAttribute('tabindex', '0');
        li.setAttribute('role', 'button');
        li.setAttribute('aria-pressed', note.id === selectedNoteId ? 'true' : 'false');
        li.dataset.id = note.id;

        const titleDiv = document.createElement('div');
        titleDiv.className = 'font-medium text-zinc-800 dark:text-zinc-200 truncate theme-transition ' +
          (note.id === selectedNoteId ? 'text-royal-red-700 dark:text-royal-red-400' : '');
        titleDiv.textContent = note.title || 'Untitled Note';

        const contentPreview = document.createElement('div');
        contentPreview.className = 'text-xs text-zinc-500 dark:text-zinc-400 mt-1 truncate theme-transition';
        contentPreview.textContent = note.content || 'No content';

        const dateSpan = document.createElement('div');
        dateSpan.className = 'text-xs text-zinc-400 dark:text-zinc-500 mt-2 theme-transition';
        const date = new Date(note.updatedAt);
        dateSpan.textContent = date.toLocaleDateString(undefined, {
          year: 'numeric',
          month: 'short',
          day: 'numeric',
        });

        li.appendChild(titleDiv);
        li.appendChild(contentPreview);
        li.appendChild(dateSpan);

        li.addEventListener('click', () => {
          selectNote(note.id);
        });
        li.addEventListener('keydown', (e) => {
          if (e.key === 'Enter' || e.key === ' ') {
            e.preventDefault();
            selectNote(note.id);
          }
        });

        notesList.appendChild(li);
      });
    }

    function selectNote(id) {
      selectedNoteId = id;
      const note = notes.find((n) => n.id === id);
      if (note) {
        noteTitle.value = note.title;
        noteContent.value = note.content;
        deleteNoteBtn.disabled = false;
        deleteNoteBtn.className = deleteNoteBtn.className.replace(
          'bg-zinc-200 dark:bg-zinc-700',
          'bg-royal-red-100 dark:bg-royal-red-900 dark:bg-opacity-20 text-royal-red-700 dark:text-royal-red-400'
        );
      }
      renderNotesList();
    }

    function clearEditor() {
      selectedNoteId = null;
      noteTitle.value = '';
      noteContent.value = '';
      deleteNoteBtn.disabled = true;
      deleteNoteBtn.className = deleteNoteBtn.className.replace(
        'bg-royal-red-100 dark:bg-royal-red-900 dark:bg-opacity-20 text-royal-red-700 dark:text-royal-red-400',
        'bg-zinc-200 dark:bg-zinc-700'
      );
      renderNotesList();
    }

    function handleSaveNote() {
      const title = noteTitle.value.trim();
      const content = noteContent.value.trim();

      if (!title && !content) {
        showNotification('Please enter a title or content for the note.');
        return;
      }

      if (selectedNoteId) {
        // Update existing note
        const noteIndex = notes.findIndex((n) => n.id === selectedNoteId);
        if (noteIndex !== -1) {
          notes[noteIndex].title = title;
          notes[noteIndex].content = content;
          notes[noteIndex].updatedAt = new Date().toISOString();
        }
      } else {
        // Create new note
        const newNote = {
          id: Date.now().toString(),
          title,
          content,
          updatedAt: new Date().toISOString(),
        };
        notes.unshift(newNote);
        selectedNoteId = newNote.id;
      }
      saveNotesToStorage();
      renderNotesList();
      showNotification('Note saved successfully!');
    }

    function handleDeleteNote() {
      if (!selectedNoteId) return;

      // Create a modal for confirmation
      const modal = document.createElement('div');
      modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';

      const modalContent = document.createElement('div');
      modalContent.className = 'bg-white dark:bg-zinc-800 rounded-lg shadow-xl p-6 max-w-md mx-4 theme-transition';

      const modalTitle = document.createElement('h3');
      modalTitle.className = 'text-lg font-semibold text-zinc-800 dark:text-white mb-3 theme-transition';
      modalTitle.textContent = 'Delete Note';

      const modalText = document.createElement('p');
      modalText.className = 'text-zinc-600 dark:text-zinc-300 mb-6 theme-transition';
      modalText.textContent = 'Are you sure you want to delete this note? This action cannot be undone.';

      const buttonContainer = document.createElement('div');
      buttonContainer.className = 'flex justify-end gap-3';

      const cancelBtn = document.createElement('button');
      cancelBtn.className = 'px-4 py-2 bg-zinc-200 dark:bg-zinc-700 text-zinc-800 dark:text-white rounded-md  hover:bg-zinc-300 dark:hover:bg-zinc-600 theme-transition';
      cancelBtn.textContent = 'Cancel';

      const confirmBtn = document.createElement('button');
      confirmBtn.className = 'px-4 py-2 bg-royal-red-600 text-white rounded-md hover:bg-royal-red-700';
      confirmBtn.textContent = 'Delete';

      buttonContainer.appendChild(cancelBtn);
      buttonContainer.appendChild(confirmBtn);

      modalContent.appendChild(modalTitle);
      modalContent.appendChild(modalText);
      modalContent.appendChild(buttonContainer);
      modal.appendChild(modalContent);

      document.body.appendChild(modal);

      cancelBtn.addEventListener('click', () => {
        document.body.removeChild(modal);
      });

      confirmBtn.addEventListener('click', () => {
        notes = notes.filter((n) => n.id !== selectedNoteId);
        saveNotesToStorage();
        clearEditor();
        document.body.removeChild(modal);
        showNotification('Note deleted successfully!');
      });
    }

    // Event Listeners
    addNoteBtn.addEventListener('click', () => {
      clearEditor();
      noteTitle.focus();
    });

    saveNoteBtn.addEventListener('click', handleSaveNote);

    noteContent.addEventListener('keydown', function (e) {
      // Ctrl/Cmd + S to save
      if ((e.ctrlKey || e.metaKey) && e.key === 's') {
        e.preventDefault();
        handleSaveNote();
      }
    });

    noteTitle.addEventListener('keydown', function (e) {
      // Ctrl/Cmd + S to save
      if ((e.ctrlKey || e.metaKey) && e.key === 's') {
        e.preventDefault();
        handleSaveNote();
      }
    });

    deleteNoteBtn.addEventListener('click', handleDeleteNote);

    themeToggle.addEventListener('click', toggleTheme);

    // Listen for system theme changes
    window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', () => {
      if (currentTheme === 'system') {
        setTheme('system');
      }
    });

    // Initialize
    initTheme();
    loadNotesFromStorage();
    renderNotesList();
    clearEditor();
  </script>
</body>

</html>
